<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>果函网——注册</title>
    <link rel="stylesheet" type="text/css" href="../../static/css/me.css" th:href="@{/css/me.css}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/semantic-ui/2.2.4/semantic.min.css">
    <style>
        body{
            margin: 0;
            width: 100%;
            color: #fff;
            background-image: linear-gradient(-20deg, #fc6076 0%, #ff9a44 100%);
            background-size: 400% 400%;animation: gradientBG 15s ease infinite;
        }
    </style>
</head>
<body>
    <nav class="ui attached segment m-shadow-small" style="padding: 0;">
        <div class="nav-top">
            <div class="ui secondary stackable menu">
                <h4 class="ui teal header item head-title"><i class="cn flag"></i>呆果果的宝函</h4>
                <a href="#" class="item head-a">首页</a>
                <a href="#" class="item head-a">视频</a>
                <a href="kit" class="item head-a">工具</a>
                <a href="#" class="item head-a">技术摘要</a>
                <a href="#" class="item head-a">关于本站</a>
                <div class="item right"></div>
                <a th:if="${null==session.user}" href="foreLogin" class="item head-a">登录</a>
            </div>
        </div>
    </nav>

    <div id="workArea" class="m-container m-padded-tb-big">
        <div class="ui container">
            <a class="ui green tag label">注册流程</a>
            <div style="height: 20px;"></div>
            <div class="registerErrorMessageDiv m-shadow-small">
                <div class="ui error message">
                    <i class="close icon"></i>
                    <div class="header">站长温馨提示：</div>
                    <span class="errorMessage">为规避用户身份信息泄露问题，请勿在本站使用真实身份证、银行卡信息注册，且务必留存常用邮箱或手机号便于后继提供
                        其他站内外服务</span>
                </div>
            </div>
            <div style="height: 10px;"></div>
            <div class="ui fluid form segment m-shadow-small" style="margin: 0 auto;">
                <div class="two fields">
                    <div class="field">
                        <label>账号</label>
                        <input placeholder="" type="text" v-model="user.username" onKeyUp="value=value.replace(/[\W]/g,'')">
                    </div>
                    <div class="field">
                        <label>昵称</label>
                        <input placeholder="" type="text" v-model="user.nickname">
                    </div>
                </div>
                <div class="two fields">
                    <div class="field">
                        <label>邮箱</label>
                        <input placeholder="" type="email" v-model="user.email">
                    </div>
                    <div class="field">
                        <label>上传头像（2M以内）</label>
                        <input  type="file" name="image" @change="getFile($event)" />
                    </div>
                </div>
                <div class="two fields">
                    <div class="field">
                        <label>密码</label>
                        <input placeholder="" type="password" v-model="user.password">
                    </div>
                    <div class="field">
                        <label>请再次输入密码</label>
                        <input placeholder="" type="password" v-model="user.repeatpassword">
                    </div>
                </div>
                <div class="ui two column grid">
                    <div class="column">
                        <div class="inline field">
                            <div class="ui checkbox">
                                <input type="checkbox" name="check_id" id="check_id">
                                <label>我同意此条款，<a class="ui button red mini basic">点击阅读</a>条款内容</label>
                            </div>
                        </div>
                    </div>
                    <div class="right aligned column">
                        <div class="ui right">
                            <button disabled @click="register" id="regBtn" class="ui inverted green mini button">开始注册</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="ui container">
            <div class="ui modal" style="margin-top: -12%;">
                <i class="close icon"></i>
                <div class="header"><img :src="'img/other/orange.jpg'" style="width: 35px;" />果函网条款<span>同意便遵守条约</span></div>
                <div class="content">
                    <div class="description" style="color: black">
                        <div class="ui header"></div>
                        <p>1、站长太忙没时间写这些东西，但站嘛需要完整些，参考腾讯爱奇艺等网站条约。</p>
                        <p>2、重要一点，别发政治、色情等一些列擦边球观点。</p>
                        <p>3、<a style="font-size: 8px; color: black">...</a></p>
                    </div>
                </div>
                <div class="actions">
                    <div class="ui inverted red basic button">不，我不同意</div>
                    <div class="ui inverted positive right labeled icon basic button">
                        我同意站长观点并遵守条约
                        <i class="checkmark icon"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div style="height: 200px;"></div>
    <!-- 底部 -->
    <footer>
        <div class="ui inverted vertical segment m-padded-tb-large">
            <div class="ui center aligned container">
                <div class="ui divided stackable grid" style="font-size: 12px;">
                    <p class="ui aligned">本网站提供的视资源部分收集于各大网站，本网站只提供web页面浏览服务，
                        若本站收集的资源无意侵犯了贵司版权，请给站长邮箱地址来信，我们将会在第一时间将其删除
                    </p>
                    <p class="m-text-thin m-text-spaced m-opacity-tiny">
                        <a href="#" style="color: white;">广告联系</a>
                    </p>
                    <p class="m-text-thin m-text-spaced m-opacity-tiny">
                        <a href="#" style="color: white;">关于本站</a>
                    </p>

                    <p class="m-text-thin m-text-spaced m-opacity-tiny">
                        <a href="#" style="color: white;">反馈意见</a>
                    </p>
                    <p class="m-text-thin m-text-spaced m-opacity-tiny">
                        <a href="#" style="color: white;">站外链接</a>
                    </p>
                    <p class="m-text-thin m-text-spaced m-opacity-tiny">
                        Copyright © 2020
                        <b style="">
                            <a href="http://www.bhw.com"><font color="orange">www.</font><font color="orange">bhw</font>
                                <font color="orange">.com</font></a>
                        </b>
                        All Rights Reserved
                    </p>
                </div>
            </div>
        </div>
    </footer>

    <script src="../../static/js/jquery.min.js" th:src="@{/js/jquery.min.js}"></script>
    <script src="../../static/js/vue.min.js" th:src="@{/js/vue.min.js}"></script>
    <script src="../../static/js/axios.min.js" th:src="@{/js/axios.min.js}"></script>
    <script src="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.js"></script>
    <script>
        $(function () {
            var data1 = {
                uri:'foreRegister',
                result: [],
                user:{
                    username: '',
                    nickname:'',
                    email: '',
                    avatar: '',
                    password: '',
                    repeatpassword: '',
                    statue: '未激活'
                },
                file: null
            };
            var vue = new Vue({
               el: '#workArea',
               data: data1,
               mounted:function(){ },
               methods:{
                   register:function(){
                       if(0 == this.user.username.length){
                           $("span.errorMessage").html("请输入用户名");
                           $("div.registerErrorMessageDiv").css("visibility","visible");
                           return;
                       }
                       if(0 == this.user.nickname.length){
                           $("span.errorMessage").html("请输入昵称");
                           $("div.registerErrorMessageDiv").css("visibility","visible");
                           return;
                       }
                       if(0 == this.user.email.length){
                           $("span.errorMessage").html("请输入邮箱");
                           $("div.registerErrorMessageDiv").css("visibility","visible");
                           return;
                       }
                       if(0 == this.user.password.length){
                           $("span.errorMessage").html("请输入密码");
                           $("div.registerErrorMessageDiv").css("visibility","visible");
                           return;
                       }
                       if(0 == this.user.repeatpassword.length){
                           $("span.errorMessage").html("请输入重复密码");
                           $("div.registerErrorMessageDiv").css("visibility","visible");
                           return;
                       }
                       if(this.user.password !=this.user.repeatpassword){
                           $("span.errorMessage").html("重复密码不一致");
                           $("div.registerErrorMessageDiv").css("visibility","visible");
                           return;
                       }
                       if(this.file == null){
                           $("span.errorMessage").html("未上传头像，请上传头像");
                           $("div.registerErrorMessageDiv").css("visibility","visible");
                           return;
                       }
                       var myReg = /^[-_A-Za-z0-9]+@([_A-Za-z0-9]+\.)+[A-Za-z0-9]{2,3}$/;
                       if(!myReg.test(this.user.email)) {
                           $("span.errorMessage").html("邮箱格式不正确");
                           $("div.registerErrorMessageDiv").css("visibility","visible");
                           return;
                       }

                       var url = this.uri;
                       var formData = new FormData();
                       formData.append("username", this.user.username);
                       formData.append("nickname", this.user.nickname);
                       formData.append("password", this.user.password);
                       formData.append("email", this.user.email);
                       formData.append("statue", this.user.statue);
                       formData.append("image", this.file);
                       axios.post(url,formData).then(function (response) {
                           var result = response.data;
                           if(result.code==0){
                               window.location.href = "registerSuccess";
                           }
                           else{
                               $("span.errorMessage").html(result.message);
                               $("div.registerErrorMessageDiv").css("visibility","visible");
                           }
                       });
                   },
                   getFile: function (event) {
                       this.file = event.target.files[0];
                   }
               }
            });

            //注册信息模态提示
            $(".ui.button.red.mini.basic").on("click",function () {
                $(".ui.modal").modal({
                        closable  : false,
                        onApprove : function() {
                            window.alert('操作成功');
                        },
                    })
                    .modal('show')
                ;
            })
            //消息提示关闭初始化
            $('.message .close').on('click', function () {
                $(this).closest('.message').transition('fade');
                }
            );
            //注册协议
            var regBtn = $("#regBtn");
            $("#check_id").change(function () {
                var that = $(this);
                that.prop("checked",that.prop("checked"));
                if(that.prop("checked")){
                    regBtn.prop("disabled",false)
                }else{
                    regBtn.prop("disabled",true)
                }
            });
        });

    </script>
</body>
</html>